<!DOCTYPE html>

<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<title>MyMine</title>
	<link rel="shortcut icon" href="img/kmines.ico" type="image/vnd.microsoft.icon" />

	<link rel="stylesheet" href="css/Font.css" />
	<link rel="stylesheet" href="css/MyMine.css" />
	<link rel="stylesheet" href="css/Dialog.css" />
	<link rel="stylesheet" href="css/Control.css" />
	<link rel="stylesheet" href="css/Folder.css" />
	<link rel="stylesheet" href="css/Ticket.css" />
	<link rel="stylesheet" href="css/SlideHandle.css" />

	<script src="jq/jquery-1.8.2.js" ></script>

	<script src="js/MyMine.js" ></script>
	<script src="js/Config.js" ></script>
	<script src="js/Control.js" ></script>
	<script src="js/Dialog.js" ></script>
	<script src="js/Folder.js" ></script>
	<script src="js/RedMine.js" ></script>
	<script src="js/Ticket.js" ></script>
	<script src="js/Tickets.js" ></script>
	<script src="js/Storage.js" ></script>
	<script src="js/SlideHandle.js" ></script>
	<script src="js/UI.js" ></script>

	<script>
$(function(){
	MyMine.init();
})
	</script>

</head>
<body>

	<header id="headerPanel" >
		<img id="logoImage" class="Button" src="img/kmines.png"  onclick="UI.abort()"
			alt="MyMineについて"/>
		<div id="buttons">
			<div id="buttons1" >
				<img class="Button" src="img/book_open.png" onclick="UI.help()"
						alt="ヘルプ" />
				<img class="Button" src="img/download.png" onclick="UI.download()"
						alt="フォルダの保存" />
				<img class="Button" src="img/upload.png" onclick="UI.upload()"
						alt="フォルダの復元"/>
				<img class="Button" src="img/cog.png" onclick="UI.config()"
						alt="環境設定" />
			</div>

			<div>
				<div id="buttons3">
					<nobr><input id="searchKeyword" type="text"
						onkeypress="UI.searchKeyPress(event,this)"
					/><img class="Button" src="img/find.png" onclick="UI.search()"
						alt="検索<br/>(チケット番号のみ)"/></nobr>
				</div>

				<div id="buttons2">
					<select id="projectSelector" onchange="UI.changeProject(this)"></select>
					<!-- === -->
					<img class="Button" src="img/refresh.png" onclick="UI.refresh()"
						alt="フォルダ内のチケットを最新化する<br/>(Shift+ で全フォルダ)"/>
					<span class="VSeparator"></span>
					<img id="filter_user" class="CheckButton" src="img/user_silhouette.png"
							alt="担当チケットのみ"/>
					<img id="filter_closed" class="CheckButton" src="img/bin_closed.png"
							alt="終了チケットを含める"/>
					<!--  img class="Button" src="img/bin_closed.png" onclick="UI.cleaning()"
						alt="フォルダ内の終了チケットを削除する"/ -->
				</div>
			</div>
		</div>

		<div class="DetailHeader">
			<nobr class="TFolder">フォルダ
				<img class="Button" src="img/add.png"
					onclick="UI.addFolder()" alt="フォルダ追加"/>
				<img class="Button" src="img/cross.png"
					onclick="UI.removeFolder()" alt="フォルダ削除"/>
			</nobr
			><nobr id="hNum"      class="THead TNum"    >番号<img/></nobr
			><span data-ref="hNum" data-class="TNum" class="HeaderSlideHandle"></span
			><nobr id="hCharge"   class="THead TCharge" >担当者<img/></nobr
			><span data-ref="hCharge" data-class="TCharge" class="HeaderSlideHandle"></span
			><nobr id="hUpdate"   class="THead TDate" >更新<img/></nobr
			><span data-ref="hUpdate" data-class="TDate" class="HeaderSlideHandle"></span
			><nobr id="hDueDate"  class="THead TDate"   >期日<img/></nobr
			><span data-ref="hDueDate" data-class="TDate" class="HeaderSlideHandle"></span
			><nobr id="hDoneRate" class="THead TState"  >進捗<img/></nobr
			><span data-ref="hDoneRate" data-class="TState" class="HeaderSlideHandle"></span
			><nobr id="hSubject"  class="THead TSubject">題名<img/></nobr>
		</div>
	</header>

	<section id="leftPanel">
		<section id="folders">
		</section>
		<span id="leftSlideHandle" ></span>
	</section>

	<section id="mainPanel">
		<div onscroll="UI.onScroll(this,event)">
			<div>
				<section id="tickets">
				</section>
			</div>
		</div>
	</section>


	<!-- ======================= Config Dialog =============================== -->
	<div class="DialogPanel">
		<div class="DialogMask" > </div>
		<div id="configDialog" class="Config Dialog">
			<h3>
				<img class="CloseImg" src="img/batu-red.png" onclick="Dialog.close()"/>
				<nobr>環境設定</nobr>
			</h3>
			<div>

				<table class="ConfigTable">

					<tr>
						<th>設定項目</th>
						<td/>
						<th>解説／設定値</th>
					</tr>

					<tr >
						<th >Redmine絶対パス</th>
						<td/>
						<td  >
							Redmineの絶対URL。プロトコル、ホスト名を含むURLを設定します。
							<br/>
							<input name="redmineAbsPath" size=64 />
							<br/>例: http://www.redmine.org/
						</td>
					</tr>

					<tr >
						<th >Redmine APIパス</th>
						<td/>
						<td  >
							Redmine APIの相対URL。ホスト名を含まない「/」から後のパスを設定します。
							リバースプロキシを設定している場合はプロキシのパスを設定します。
							<br/>
							<input name="redmineApiPath" size=32/> 例: /redmine/
						</td>
					</tr>

					<tr >
						<th >APIアクセスキー</th>
						<td/>
						<td  >
							Redmineの個人設定で取得できるAPIアクセスキーを設定します。
							<br/>
							<input name="redmineApiKey" size=64/> <br/>例: d557be383b862e3f852be39ae1716a1f
						</td>
					</tr>

					<tr >
						<th >カスタムクエリ</th>
						<td/>
						<td>
							古い Redmine の為の機能です。<br/>
							APIでソート条件が使用できないバージョンの Redmine でのみ使用します。
							このモードを使用すると新着フォルダで更新日以外のソートは使えませんので
							通常は空欄としておいて下さい。<br/>
							<a href="#">こちらの例にしたがってカスタムクエリを作成し</a>そのIDを設定します。
							<br/>
							<input name="redmineQueryId" size=2/> 例: 5
						</td>
					</tr>

					<tr >
						<th >プロジェクト一覧</th>
						<td/>
						<td>
							以下のボタンからプロジェクトを自動取得して設定します。
							プロジェクトの変更が有った場合には再取得して設定しなおします。
							<br/>
							<button onclick="UI.getProjects()">プロジェクトの自動取得</button>
							(先にAPIの項目の設定が必要です)
							<br/>
							<div id="configProjectList">
							</div>
						</td>
					</tr>

				</table>

				<br/>
				<div align="center">
					<button onclick="UI.saveConfig()">保存</button>
					<button onclick="Dialog.close()">キャンセル</button>
				</div>
				<br/>
			</div>
		</div>


		<div id="downloadDialog" class="Dialog">
			<h3>
				<img class="CloseImg" src="img/batu-red.png" onclick="Dialog.close()"/>
				<nobr>ダウンロード</nobr>
			</h3>
			<div>
				<br/>
				<p align="center">
					フォルダと環境設定の状態を保存します。<br/><br/>
					<a id="downloadLink" download="mymine.json" >
					このリンクを「別名で保存」して下さい。
					</a>
				</p>
			</div>
		</div>

		<div id="uploadDialog" class="Dialog">
			<h3>
				<img class="CloseImg" src="img/batu-red.png" onclick="Dialog.close()"/>
				<nobr>アップロード</nobr>
			</h3>
			<div>
				<br/>
				<p align="center">
					フォルダと環境設定の状態を復元します。<br/>
					ファイル名を選択して下さい<br/><br/>
					<p align="center">
						<input id="uploadFile" type="file" />
					</p>
				</p>
			</div>
		</div>

		<div id="addFolderDialog" class="Dialog">
			<h3>
				<img class="CloseImg" src="img/batu-red.png" onclick="Dialog.close()"/>
				<nobr>フォルダ追加</nobr>
			</h3>
			<div>

				<table class="ConfigTable">

					<tr>
						<th>設定項目</th>
						<td/>
						<th>解説／設定値</th>
					</tr>
					<tr >
						<th >フォルダID</th>
						<td/>
						<td  >
							一意のフォルダID。英数字のみ。
							<br/><input name="folderName" size=16/>
							<br/>例: myfolder
						</td>
					</tr>

					<tr >
						<th >アイコン</th>
						<td/>
						<td  >現在は固定。
							<br/><img src="img/folder.png" />
							<input name="folderIcon" size="32" value="img/folder.png" />
						</td>
					</tr>


					<tr >
						<th >フォルダ表示名</th>
						<td/>
						<td  >
							画面上に表示するフォルダの名前。
							<br/><input name="folderTitle" size=32/>
							<br/>例: マイフォルダ
						</td>
					</tr>
				</table>

				<br/>
				<div align="center">
					<button onclick="UI.saveAddFolder()">追加</button>
					<button onclick="Dialog.close()">キャンセル</button>
				</div>
				<br/>

			</div>
		</div>

		<div id="abortDialog" class="Dialog">
			<h3>
				<img class="CloseImg" src="img/batu-red.png" onclick="Dialog.close()"/>
				<nobr>MyMineについて</nobr>
			</h3>
			<div>
				<p align="center">
					MyMine Ver-0.1<br/>
					Copyright (C) 2012 koremaru.org.<br/>
				</p>

			</div>
		</div>
	</div>


	<!-- ======================= Waiting =============================== -->
	<div id="waiting">
		<img src="img/waiting.gif" />
		<div id="progressBar"><div></div></div>
	</div>
	<!-- ======================= Balloon =============================== -->
	<div id="balloon" ></div>

	<!-- ================ Template =================================== -->
	<div class="Template">
		<article id="templ_ticket" class="Ticket">
			<nobr  data-field="num"        class="TNum"></nobr
			><nobr data-field="charge"     class="TCharge"></nobr
			><nobr data-field="updateDate" class="TDate"></nobr
			><nobr data-field="limitDate"  class="TDate"></nobr
			><nobr data-field="state"      class="TState"><div class="StateBar"><div></div></div></nobr
			><nobr data-field="subject"    class="TSubject"></nobr>
		</article>

		<article id="templ_folder" class="Folder"></article>

		<div id="templ_project">
			<input name="redmineProjectName" size=50/>
			<input name="redmineProjectId" size=4/>
		</div>

	</div>

</body>
</html>
